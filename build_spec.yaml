version: 0.1          # debe ser exactamente 0.1
component: build      # indica que esto es un build spec

timeoutInSeconds: 3600  # opcional, tiempo m√°ximo de ejecuci√≥n (1 h)

steps:
  - type: Command
    name: Build & Push Docker image
    command: |
      echo "üî® Construyendo y subiendo imagen Docker..."
      cd MtdrSpring/backend

      # Usa 'latest' si image_tag no est√° definido
      TAG=${image_tag:-latest}

      docker build \
        -t iad.ocir.io/axm8kysebnqa/reacttodo/s78fu/todolistapp-springboot:$TAG \
        -f Dockerfile \
        .

      docker push iad.ocir.io/axm8kysebnqa/reacttodo/s78fu/todolistapp-springboot:$TAG

outputArtifacts:
  - name: todolist-image
    type: DOCKER_IMAGE
    location: iad.ocir.io/axm8kysebnqa/reacttodo/s78fu/todolistapp-springboot:${TAG}
