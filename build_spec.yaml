version: 0.1          # debe ser exactamente 0.1
component: build      # indica que esto es un build spec

timeoutInSeconds: 3600  # opcional, tiempo m√°ximo de ejecuci√≥n (1 h)
environment:
  variables:
    IMAGE_TAG: ${image_tag}  # la variable que definiste en ‚ÄúParameters‚Äù del pipeline

steps:
  - type: Command
    name: Entrar al c√≥digo
    command: |
      echo "üõ†Ô∏è Entrando al directorio MtdrSpring/backend..."
      cd MtdrSpring/backend

  - type: Command
    name: Construir imagen
    command: |
      echo "üî® Construyendo imagen Docker..."
      docker build \
        -t iad.ocir.io/axm8kysebnqa/reacttodo/s78fu/todolistapp-springboot:${IMAGE_TAG} \
        -f Dockerfile \
        .

  - type: Command
    name: Subir imagen
    command: |
      echo "Pushing imagen a OCIR..."
      docker push iad.ocir.io/axm8kysebnqa/reacttodo/s78fu/todolistapp-springboot:${IMAGE_TAG}

outputArtifacts:
  - name: todolist-image
    type: DOCKER_IMAGE
    location: iad.ocir.io/axm8kysebnqa/reacttodo/s78fu/todolistapp-springboot:${IMAGE_TAG}
